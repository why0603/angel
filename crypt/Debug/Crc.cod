; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.30319.01 

	TITLE	D:\windows\belial\crypt\Crc.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

CONST	SEGMENT
_crc32Table DD	00H
	DD	077073096H
	DD	0ee0e612cH
	DD	0990951baH
	DD	076dc419H
	DD	0706af48fH
	DD	0e963a535H
	DD	09e6495a3H
	DD	0edb8832H
	DD	079dcb8a4H
	DD	0e0d5e91eH
	DD	097d2d988H
	DD	09b64c2bH
	DD	07eb17cbdH
	DD	0e7b82d07H
	DD	090bf1d91H
	DD	01db71064H
	DD	06ab020f2H
	DD	0f3b97148H
	DD	084be41deH
	DD	01adad47dH
	DD	06ddde4ebH
	DD	0f4d4b551H
	DD	083d385c7H
	DD	0136c9856H
	DD	0646ba8c0H
	DD	0fd62f97aH
	DD	08a65c9ecH
	DD	014015c4fH
	DD	063066cd9H
	DD	0fa0f3d63H
	DD	08d080df5H
	DD	03b6e20c8H
	DD	04c69105eH
	DD	0d56041e4H
	DD	0a2677172H
	DD	03c03e4d1H
	DD	04b04d447H
	DD	0d20d85fdH
	DD	0a50ab56bH
	DD	035b5a8faH
	DD	042b2986cH
	DD	0dbbbc9d6H
	DD	0acbcf940H
	DD	032d86ce3H
	DD	045df5c75H
	DD	0dcd60dcfH
	DD	0abd13d59H
	DD	026d930acH
	DD	051de003aH
	DD	0c8d75180H
	DD	0bfd06116H
	DD	021b4f4b5H
	DD	056b3c423H
	DD	0cfba9599H
	DD	0b8bda50fH
	DD	02802b89eH
	DD	05f058808H
	DD	0c60cd9b2H
	DD	0b10be924H
	DD	02f6f7c87H
	DD	058684c11H
	DD	0c1611dabH
	DD	0b6662d3dH
	DD	076dc4190H
	DD	01db7106H
	DD	098d220bcH
	DD	0efd5102aH
	DD	071b18589H
	DD	06b6b51fH
	DD	09fbfe4a5H
	DD	0e8b8d433H
	DD	07807c9a2H
	DD	0f00f934H
	DD	09609a88eH
	DD	0e10e9818H
	DD	07f6a0dbbH
	DD	086d3d2dH
	DD	091646c97H
	DD	0e6635c01H
	DD	06b6b51f4H
	DD	01c6c6162H
	DD	0856530d8H
	DD	0f262004eH
	DD	06c0695edH
	DD	01b01a57bH
	DD	08208f4c1H
	DD	0f50fc457H
	DD	065b0d9c6H
	DD	012b7e950H
	DD	08bbeb8eaH
	DD	0fcb9887cH
	DD	062dd1ddfH
	DD	015da2d49H
	DD	08cd37cf3H
	DD	0fbd44c65H
	DD	04db26158H
	DD	03ab551ceH
	DD	0a3bc0074H
	DD	0d4bb30e2H
	DD	04adfa541H
	DD	03dd895d7H
	DD	0a4d1c46dH
	DD	0d3d6f4fbH
	DD	04369e96aH
	DD	0346ed9fcH
	DD	0ad678846H
	DD	0da60b8d0H
	DD	044042d73H
	DD	033031de5H
	DD	0aa0a4c5fH
	DD	0dd0d7cc9H
	DD	05005713cH
	DD	0270241aaH
	DD	0be0b1010H
	DD	0c90c2086H
	DD	05768b525H
	DD	0206f85b3H
	DD	0b966d409H
	DD	0ce61e49fH
	DD	05edef90eH
	DD	029d9c998H
	DD	0b0d09822H
	DD	0c7d7a8b4H
	DD	059b33d17H
	DD	02eb40d81H
	DD	0b7bd5c3bH
	DD	0c0ba6cadH
	DD	0edb88320H
	DD	09abfb3b6H
	DD	03b6e20cH
	DD	074b1d29aH
	DD	0ead54739H
	DD	09dd277afH
	DD	04db2615H
	DD	073dc1683H
	DD	0e3630b12H
	DD	094643b84H
	DD	0d6d6a3eH
	DD	07a6a5aa8H
	DD	0e40ecf0bH
	DD	09309ff9dH
	DD	0a00ae27H
	DD	07d079eb1H
	DD	0f00f9344H
	DD	08708a3d2H
	DD	01e01f268H
	DD	06906c2feH
	DD	0f762575dH
	DD	0806567cbH
	DD	0196c3671H
	DD	06e6b06e7H
	DD	0fed41b76H
	DD	089d32be0H
	DD	010da7a5aH
	DD	067dd4accH
	DD	0f9b9df6fH
	DD	08ebeeff9H
	DD	017b7be43H
	DD	060b08ed5H
	DD	0d6d6a3e8H
	DD	0a1d1937eH
	DD	038d8c2c4H
	DD	04fdff252H
	DD	0d1bb67f1H
	DD	0a6bc5767H
	DD	03fb506ddH
	DD	048b2364bH
	DD	0d80d2bdaH
	DD	0af0a1b4cH
	DD	036034af6H
	DD	041047a60H
	DD	0df60efc3H
	DD	0a867df55H
	DD	0316e8eefH
	DD	04669be79H
	DD	0cb61b38cH
	DD	0bc66831aH
	DD	0256fd2a0H
	DD	05268e236H
	DD	0cc0c7795H
	DD	0bb0b4703H
	DD	0220216b9H
	DD	05505262fH
	DD	0c5ba3bbeH
	DD	0b2bd0b28H
	DD	02bb45a92H
	DD	05cb36a04H
	DD	0c2d7ffa7H
	DD	0b5d0cf31H
	DD	02cd99e8bH
	DD	05bdeae1dH
	DD	09b64c2b0H
	DD	0ec63f226H
	DD	0756aa39cH
	DD	026d930aH
	DD	09c0906a9H
	DD	0eb0e363fH
	DD	072076785H
	DD	05005713H
	DD	095bf4a82H
	DD	0e2b87a14H
	DD	07bb12baeH
	DD	0cb61b38H
	DD	092d28e9bH
	DD	0e5d5be0dH
	DD	07cdcefb7H
	DD	0bdbdf21H
	DD	086d3d2d4H
	DD	0f1d4e242H
	DD	068ddb3f8H
	DD	01fda836eH
	DD	081be16cdH
	DD	0f6b9265bH
	DD	06fb077e1H
	DD	018b74777H
	DD	088085ae6H
	DD	0ff0f6a70H
	DD	066063bcaH
	DD	011010b5cH
	DD	08f659effH
	DD	0f862ae69H
	DD	0616bffd3H
	DD	0166ccf45H
	DD	0a00ae278H
	DD	0d70dd2eeH
	DD	04e048354H
	DD	03903b3c2H
	DD	0a7672661H
	DD	0d06016f7H
	DD	04969474dH
	DD	03e6e77dbH
	DD	0aed16a4aH
	DD	0d9d65adcH
	DD	040df0b66H
	DD	037d83bf0H
	DD	0a9bcae53H
	DD	0debb9ec5H
	DD	047b2cf7fH
	DD	030b5ffe9H
	DD	0bdbdf21cH
	DD	0cabac28aH
	DD	053b39330H
	DD	024b4a3a6H
	DD	0bad03605H
	DD	0cdd70693H
	DD	054de5729H
	DD	023d967bfH
	DD	0b3667a2eH
	DD	0c4614ab8H
	DD	05d681b02H
	DD	02a6f2b94H
	DD	0b40bbe37H
	DD	0c30c8ea1H
	DD	05a05df1bH
	DD	02d02ef8dH
_crc64Table DQ	0000000000000000H
	DQ	42f0e1eba9ea3693H
	DQ	85e1c3d753d46d26H
	DQ	c711223cfa3e5bb5H
	DQ	493366450e42ecdfH
	DQ	0bc387aea7a8da4cH
	DQ	ccd2a5925d9681f9H
	DQ	8e224479f47cb76aH
	DQ	9266cc8a1c85d9beH
	DQ	d0962d61b56fef2dH
	DQ	17870f5d4f51b498H
	DQ	5577eeb6e6bb820bH
	DQ	db55aacf12c73561H
	DQ	99a54b24bb2d03f2H
	DQ	5eb4691841135847H
	DQ	1c4488f3e8f96ed4H
	DQ	663d78ff90e185efH
	DQ	24cd9914390bb37cH
	DQ	e3dcbb28c335e8c9H
	DQ	a12c5ac36adfde5aH
	DQ	2f0e1eba9ea36930H
	DQ	6dfeff5137495fa3H
	DQ	aaefdd6dcd770416H
	DQ	e81f3c86649d3285H
	DQ	f45bb4758c645c51H
	DQ	b6ab559e258e6ac2H
	DQ	71ba77a2dfb03177H
	DQ	334a9649765a07e4H
	DQ	bd68d2308226b08eH
	DQ	ff9833db2bcc861dH
	DQ	388911e7d1f2dda8H
	DQ	7a79f00c7818eb3bH
	DQ	cc7af1ff21c30bdeH
	DQ	8e8a101488293d4dH
	DQ	499b3228721766f8H
	DQ	0b6bd3c3dbfd506bH
	DQ	854997ba2f81e701H
	DQ	c7b97651866bd192H
	DQ	00a8546d7c558a27H
	DQ	4258b586d5bfbcb4H
	DQ	5e1c3d753d46d260H
	DQ	1cecdc9e94ace4f3H
	DQ	dbfdfea26e92bf46H
	DQ	990d1f49c77889d5H
	DQ	172f5b3033043ebfH
	DQ	55dfbadb9aee082cH
	DQ	92ce98e760d05399H
	DQ	d03e790cc93a650aH
	DQ	aa478900b1228e31H
	DQ	e8b768eb18c8b8a2H
	DQ	2fa64ad7e2f6e317H
	DQ	6d56ab3c4b1cd584H
	DQ	e374ef45bf6062eeH
	DQ	a1840eae168a547dH
	DQ	66952c92ecb40fc8H
	DQ	2465cd79455e395bH
	DQ	3821458aada7578fH
	DQ	7ad1a461044d611cH
	DQ	bdc0865dfe733aa9H
	DQ	ff3067b657990c3aH
	DQ	711223cfa3e5bb50H
	DQ	33e2c2240a0f8dc3H
	DQ	f4f3e018f031d676H
	DQ	b60301f359dbe0e5H
	DQ	da050215ea6c212fH
	DQ	98f5e3fe438617bcH
	DQ	5fe4c1c2b9b84c09H
	DQ	1d14202910527a9aH
	DQ	93366450e42ecdf0H
	DQ	d1c685bb4dc4fb63H
	DQ	16d7a787b7faa0d6H
	DQ	5427466c1e109645H
	DQ	4863ce9ff6e9f891H
	DQ	0a932f745f03ce02H
	DQ	cd820d48a53d95b7H
	DQ	8f72eca30cd7a324H
	DQ	0150a8daf8ab144eH
	DQ	43a04931514122ddH
	DQ	84b16b0dab7f7968H
	DQ	c6418ae602954ffbH
	DQ	bc387aea7a8da4c0H
	DQ	fec89b01d3679253H
	DQ	39d9b93d2959c9e6H
	DQ	7b2958d680b3ff75H
	DQ	f50b1caf74cf481fH
	DQ	b7fbfd44dd257e8cH
	DQ	70eadf78271b2539H
	DQ	321a3e938ef113aaH
	DQ	2e5eb66066087d7eH
	DQ	6cae578bcfe24bedH
	DQ	abbf75b735dc1058H
	DQ	e94f945c9c3626cbH
	DQ	676dd025684a91a1H
	DQ	259d31cec1a0a732H
	DQ	e28c13f23b9efc87H
	DQ	a07cf2199274ca14H
	DQ	167ff3eacbaf2af1H
	DQ	548f120162451c62H
	DQ	939e303d987b47d7H
	DQ	d16ed1d631917144H
	DQ	5f4c95afc5edc62eH
	DQ	1dbc74446c07f0bdH
	DQ	daad56789639ab08H
	DQ	985db7933fd39d9bH
	DQ	84193f60d72af34fH
	DQ	c6e9de8b7ec0c5dcH
	DQ	01f8fcb784fe9e69H
	DQ	43081d5c2d14a8faH
	DQ	cd2a5925d9681f90H
	DQ	8fdab8ce70822903H
	DQ	48cb9af28abc72b6H
	DQ	0a3b7b1923564425H
	DQ	70428b155b4eaf1eH
	DQ	32b26afef2a4998dH
	DQ	f5a348c2089ac238H
	DQ	b753a929a170f4abH
	DQ	3971ed50550c43c1H
	DQ	7b810cbbfce67552H
	DQ	bc902e8706d82ee7H
	DQ	fe60cf6caf321874H
	DQ	e224479f47cb76a0H
	DQ	a0d4a674ee214033H
	DQ	67c58448141f1b86H
	DQ	253565a3bdf52d15H
	DQ	ab1721da49899a7fH
	DQ	e9e7c031e063acecH
	DQ	2ef6e20d1a5df759H
	DQ	6c0603e6b3b7c1caH
	DQ	f6fae5c07d3274cdH
	DQ	b40a042bd4d8425eH
	DQ	731b26172ee619ebH
	DQ	31ebc7fc870c2f78H
	DQ	bfc9838573709812H
	DQ	fd39626eda9aae81H
	DQ	3a28405220a4f534H
	DQ	78d8a1b9894ec3a7H
	DQ	649c294a61b7ad73H
	DQ	266cc8a1c85d9be0H
	DQ	e17dea9d3263c055H
	DQ	a38d0b769b89f6c6H
	DQ	2daf4f0f6ff541acH
	DQ	6f5faee4c61f773fH
	DQ	a84e8cd83c212c8aH
	DQ	eabe6d3395cb1a19H
	DQ	90c79d3fedd3f122H
	DQ	d2377cd44439c7b1H
	DQ	15265ee8be079c04H
	DQ	57d6bf0317edaa97H
	DQ	d9f4fb7ae3911dfdH
	DQ	9b041a914a7b2b6eH
	DQ	5c1538adb04570dbH
	DQ	1ee5d94619af4648H
	DQ	02a151b5f156289cH
	DQ	4051b05e58bc1e0fH
	DQ	87409262a28245baH
	DQ	c5b073890b687329H
	DQ	4b9237f0ff14c443H
	DQ	0962d61b56fef2d0H
	DQ	ce73f427acc0a965H
	DQ	8c8315cc052a9ff6H
	DQ	3a80143f5cf17f13H
	DQ	7870f5d4f51b4980H
	DQ	bf61d7e80f251235H
	DQ	fd913603a6cf24a6H
	DQ	73b3727a52b393ccH
	DQ	31439391fb59a55fH
	DQ	f652b1ad0167feeaH
	DQ	b4a25046a88dc879H
	DQ	a8e6d8b54074a6adH
	DQ	ea16395ee99e903eH
	DQ	2d071b6213a0cb8bH
	DQ	6ff7fa89ba4afd18H
	DQ	e1d5bef04e364a72H
	DQ	a3255f1be7dc7ce1H
	DQ	64347d271de22754H
	DQ	26c49cccb40811c7H
	DQ	5cbd6cc0cc10fafcH
	DQ	1e4d8d2b65facc6fH
	DQ	d95caf179fc497daH
	DQ	9bac4efc362ea149H
	DQ	158e0a85c2521623H
	DQ	577eeb6e6bb820b0H
	DQ	906fc95291867b05H
	DQ	d29f28b9386c4d96H
	DQ	cedba04ad0952342H
	DQ	8c2b41a1797f15d1H
	DQ	4b3a639d83414e64H
	DQ	09ca82762aab78f7H
	DQ	87e8c60fded7cf9dH
	DQ	c51827e4773df90eH
	DQ	020905d88d03a2bbH
	DQ	40f9e43324e99428H
	DQ	2cffe7d5975e55e2H
	DQ	6e0f063e3eb46371H
	DQ	a91e2402c48a38c4H
	DQ	ebeec5e96d600e57H
	DQ	65cc8190991cb93dH
	DQ	273c607b30f68faeH
	DQ	e02d4247cac8d41bH
	DQ	a2dda3ac6322e288H
	DQ	be992b5f8bdb8c5cH
	DQ	fc69cab42231bacfH
	DQ	3b78e888d80fe17aH
	DQ	7988096371e5d7e9H
	DQ	f7aa4d1a85996083H
	DQ	b55aacf12c735610H
	DQ	724b8ecdd64d0da5H
	DQ	30bb6f267fa73b36H
	DQ	4ac29f2a07bfd00dH
	DQ	08327ec1ae55e69eH
	DQ	cf235cfd546bbd2bH
	DQ	8dd3bd16fd818bb8H
	DQ	03f1f96f09fd3cd2H
	DQ	41011884a0170a41H
	DQ	86103ab85a2951f4H
	DQ	c4e0db53f3c36767H
	DQ	d8a453a01b3a09b3H
	DQ	9a54b24bb2d03f20H
	DQ	5d45907748ee6495H
	DQ	1fb5719ce1045206H
	DQ	919735e51578e56cH
	DQ	d367d40ebc92d3ffH
	DQ	1476f63246ac884aH
	DQ	568617d9ef46bed9H
	DQ	e085162ab69d5e3cH
	DQ	a275f7c11f7768afH
	DQ	6564d5fde549331aH
	DQ	279434164ca30589H
	DQ	a9b6706fb8dfb2e3H
	DQ	eb46918411358470H
	DQ	2c57b3b8eb0bdfc5H
	DQ	6ea7525342e1e956H
	DQ	72e3daa0aa188782H
	DQ	30133b4b03f2b111H
	DQ	f7021977f9cceaa4H
	DQ	b5f2f89c5026dc37H
	DQ	3bd0bce5a45a6b5dH
	DQ	79205d0e0db05dceH
	DQ	be317f32f78e067bH
	DQ	fcc19ed95e6430e8H
	DQ	86b86ed5267cdbd3H
	DQ	c4488f3e8f96ed40H
	DQ	0359ad0275a8b6f5H
	DQ	41a94ce9dc428066H
	DQ	cf8b0890283e370cH
	DQ	8d7be97b81d4019fH
	DQ	4a6acb477bea5a2aH
	DQ	089a2aacd2006cb9H
	DQ	14dea25f3af9026dH
	DQ	562e43b4931334feH
	DQ	913f6188692d6f4bH
	DQ	d3cf8063c0c759d8H
	DQ	5dedc41a34bbeeb2H
	DQ	1f1d25f19d51d821H
	DQ	d80c07cd676f8394H
	DQ	9afce626ce85b507H
CONST	ENDS
PUBLIC	_GenCrc32Table
EXTRN	__RTC_CheckEsp:PROC
EXTRN	__RTC_Shutdown:PROC
EXTRN	__RTC_InitBase:PROC
;	COMDAT rtc$TMZ
; File d:\windows\belial\crypt\crc.c
rtc$TMZ	SEGMENT
__RTC_Shutdown.rtc$TMZ DD FLAT:__RTC_Shutdown
rtc$TMZ	ENDS
;	COMDAT rtc$IMZ
rtc$IMZ	SEGMENT
__RTC_InitBase.rtc$IMZ DD FLAT:__RTC_InitBase
; Function compile flags: /Odtp /RTCsu /ZI
rtc$IMZ	ENDS
;	COMDAT _GenCrc32Table
_TEXT	SEGMENT
_j$ = -80						; size = 4
_i$ = -68						; size = 4
_flag$ = -56						; size = 4
_t2$ = -44						; size = 4
_t1$ = -32						; size = 4
_temp$ = -20						; size = 4
_crc$ = -8						; size = 4
_pTable$ = 8						; size = 4
_GenCrc32Table PROC					; COMDAT

; 134  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 14 01 00
	00		 sub	 esp, 276		; 00000114H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd ec fe ff
	ff		 lea	 edi, DWORD PTR [ebp-276]
  00012	b9 45 00 00 00	 mov	 ecx, 69			; 00000045H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 135  : 	unsigned int crc,temp,t1,t2,flag; 
; 136  : 	int i,j;
; 137  : 	if (0 != pTable)

  0001e	83 7d 08 00	 cmp	 DWORD PTR _pTable$[ebp], 0
  00022	0f 84 cc 00 00
	00		 je	 $LN10@GenCrc32Ta

; 138  : 	{
; 139  : 		// 256个值 
; 140  : 		for(i = 0; i <= 0xFF; i++) 

  00028	c7 45 bc 00 00
	00 00		 mov	 DWORD PTR _i$[ebp], 0
  0002f	eb 09		 jmp	 SHORT $LN8@GenCrc32Ta
$LN7@GenCrc32Ta:
  00031	8b 45 bc	 mov	 eax, DWORD PTR _i$[ebp]
  00034	83 c0 01	 add	 eax, 1
  00037	89 45 bc	 mov	 DWORD PTR _i$[ebp], eax
$LN8@GenCrc32Ta:
  0003a	81 7d bc ff 00
	00 00		 cmp	 DWORD PTR _i$[ebp], 255	; 000000ffH
  00041	0f 8f ad 00 00
	00		 jg	 $LN10@GenCrc32Ta

; 141  : 		{ 
; 142  : 			temp = reflect((unsigned int)i, 8); 

  00047	6a 08		 push	 8
  00049	8b 45 bc	 mov	 eax, DWORD PTR _i$[ebp]
  0004c	50		 push	 eax
  0004d	e8 00 00 00 00	 call	 _reflect
  00052	83 c4 08	 add	 esp, 8
  00055	89 45 ec	 mov	 DWORD PTR _temp$[ebp], eax

; 143  : 			pTable[i] = temp<< 24; 

  00058	8b 45 ec	 mov	 eax, DWORD PTR _temp$[ebp]
  0005b	c1 e0 18	 shl	 eax, 24			; 00000018H
  0005e	8b 4d bc	 mov	 ecx, DWORD PTR _i$[ebp]
  00061	8b 55 08	 mov	 edx, DWORD PTR _pTable$[ebp]
  00064	89 04 8a	 mov	 DWORD PTR [edx+ecx*4], eax

; 144  : 			for (j = 0; j < 8; j++)

  00067	c7 45 b0 00 00
	00 00		 mov	 DWORD PTR _j$[ebp], 0
  0006e	eb 09		 jmp	 SHORT $LN5@GenCrc32Ta
$LN4@GenCrc32Ta:
  00070	8b 45 b0	 mov	 eax, DWORD PTR _j$[ebp]
  00073	83 c0 01	 add	 eax, 1
  00076	89 45 b0	 mov	 DWORD PTR _j$[ebp], eax
$LN5@GenCrc32Ta:
  00079	83 7d b0 08	 cmp	 DWORD PTR _j$[ebp], 8
  0007d	7d 47		 jge	 SHORT $LN3@GenCrc32Ta

; 145  : 			{ 
; 146  : 				flag = pTable[i] & 0x80000000; 

  0007f	8b 45 bc	 mov	 eax, DWORD PTR _i$[ebp]
  00082	8b 4d 08	 mov	 ecx, DWORD PTR _pTable$[ebp]
  00085	8b 14 81	 mov	 edx, DWORD PTR [ecx+eax*4]
  00088	81 e2 00 00 00
	80		 and	 edx, -2147483648	; 80000000H
  0008e	89 55 c8	 mov	 DWORD PTR _flag$[ebp], edx

; 147  : 				t1 = (pTable[i] << 1); 

  00091	8b 45 bc	 mov	 eax, DWORD PTR _i$[ebp]
  00094	8b 4d 08	 mov	 ecx, DWORD PTR _pTable$[ebp]
  00097	8b 14 81	 mov	 edx, DWORD PTR [ecx+eax*4]
  0009a	d1 e2		 shl	 edx, 1
  0009c	89 55 e0	 mov	 DWORD PTR _t1$[ebp], edx

; 148  : 				if(flag == 0) 

  0009f	83 7d c8 00	 cmp	 DWORD PTR _flag$[ebp], 0
  000a3	75 09		 jne	 SHORT $LN2@GenCrc32Ta

; 149  : 					t2 = 0; 

  000a5	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _t2$[ebp], 0

; 150  : 				else 

  000ac	eb 07		 jmp	 SHORT $LN1@GenCrc32Ta
$LN2@GenCrc32Ta:

; 151  : 					t2 = CRC32; 

  000ae	c7 45 d4 b7 1d
	c1 04		 mov	 DWORD PTR _t2$[ebp], 79764919 ; 04c11db7H
$LN1@GenCrc32Ta:

; 152  : 				pTable[i] = t1 ^ t2 ; 

  000b5	8b 45 e0	 mov	 eax, DWORD PTR _t1$[ebp]
  000b8	33 45 d4	 xor	 eax, DWORD PTR _t2$[ebp]
  000bb	8b 4d bc	 mov	 ecx, DWORD PTR _i$[ebp]
  000be	8b 55 08	 mov	 edx, DWORD PTR _pTable$[ebp]
  000c1	89 04 8a	 mov	 DWORD PTR [edx+ecx*4], eax

; 153  : 			} 

  000c4	eb aa		 jmp	 SHORT $LN4@GenCrc32Ta
$LN3@GenCrc32Ta:

; 154  : 			crc = pTable[i]; 

  000c6	8b 45 bc	 mov	 eax, DWORD PTR _i$[ebp]
  000c9	8b 4d 08	 mov	 ecx, DWORD PTR _pTable$[ebp]
  000cc	8b 14 81	 mov	 edx, DWORD PTR [ecx+eax*4]
  000cf	89 55 f8	 mov	 DWORD PTR _crc$[ebp], edx

; 155  : 			pTable[i] = reflect(pTable[i], 32); 

  000d2	6a 20		 push	 32			; 00000020H
  000d4	8b 45 bc	 mov	 eax, DWORD PTR _i$[ebp]
  000d7	8b 4d 08	 mov	 ecx, DWORD PTR _pTable$[ebp]
  000da	8b 14 81	 mov	 edx, DWORD PTR [ecx+eax*4]
  000dd	52		 push	 edx
  000de	e8 00 00 00 00	 call	 _reflect
  000e3	83 c4 08	 add	 esp, 8
  000e6	8b 4d bc	 mov	 ecx, DWORD PTR _i$[ebp]
  000e9	8b 55 08	 mov	 edx, DWORD PTR _pTable$[ebp]
  000ec	89 04 8a	 mov	 DWORD PTR [edx+ecx*4], eax

; 156  : 		}

  000ef	e9 3d ff ff ff	 jmp	 $LN7@GenCrc32Ta
$LN10@GenCrc32Ta:

; 157  : 	}
; 158  : }

  000f4	5f		 pop	 edi
  000f5	5e		 pop	 esi
  000f6	5b		 pop	 ebx
  000f7	81 c4 14 01 00
	00		 add	 esp, 276		; 00000114H
  000fd	3b ec		 cmp	 ebp, esp
  000ff	e8 00 00 00 00	 call	 __RTC_CheckEsp
  00104	8b e5		 mov	 esp, ebp
  00106	5d		 pop	 ebp
  00107	c3		 ret	 0
_GenCrc32Table ENDP
; Function compile flags: /Odtp /RTCsu /ZI
_TEXT	ENDS
;	COMDAT _reflect
_TEXT	SEGMENT
_i$ = -20						; size = 4
_value$ = -8						; size = 4
_refx$ = 8						; size = 4
_ch$ = 12						; size = 4
_reflect PROC						; COMDAT

; 120  : { 

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec d8 00 00
	00		 sub	 esp, 216		; 000000d8H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 28 ff ff
	ff		 lea	 edi, DWORD PTR [ebp-216]
  00012	b9 36 00 00 00	 mov	 ecx, 54			; 00000036H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 121  : 	unsigned int value = 0; 

  0001e	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _value$[ebp], 0

; 122  : 	int i;
; 123  : 	// 交换bit0和bit7，bit1和bit6，类推 
; 124  : 	for(i = 1; i < (ch + 1); i++) 

  00025	c7 45 ec 01 00
	00 00		 mov	 DWORD PTR _i$[ebp], 1
  0002c	eb 09		 jmp	 SHORT $LN4@reflect
$LN3@reflect:
  0002e	8b 45 ec	 mov	 eax, DWORD PTR _i$[ebp]
  00031	83 c0 01	 add	 eax, 1
  00034	89 45 ec	 mov	 DWORD PTR _i$[ebp], eax
$LN4@reflect:
  00037	8b 45 0c	 mov	 eax, DWORD PTR _ch$[ebp]
  0003a	83 c0 01	 add	 eax, 1
  0003d	39 45 ec	 cmp	 DWORD PTR _i$[ebp], eax
  00040	7d 25		 jge	 SHORT $LN2@reflect

; 125  : 	{ 
; 126  : 		if(0 != (refx & 1)) 

  00042	8b 45 08	 mov	 eax, DWORD PTR _refx$[ebp]
  00045	83 e0 01	 and	 eax, 1
  00048	74 13		 je	 SHORT $LN1@reflect

; 127  : 			value |= (unsigned int)(1 << (ch - i)); 

  0004a	8b 4d 0c	 mov	 ecx, DWORD PTR _ch$[ebp]
  0004d	2b 4d ec	 sub	 ecx, DWORD PTR _i$[ebp]
  00050	b8 01 00 00 00	 mov	 eax, 1
  00055	d3 e0		 shl	 eax, cl
  00057	0b 45 f8	 or	 eax, DWORD PTR _value$[ebp]
  0005a	89 45 f8	 mov	 DWORD PTR _value$[ebp], eax
$LN1@reflect:

; 128  : 		refx >>= 1; 

  0005d	8b 45 08	 mov	 eax, DWORD PTR _refx$[ebp]
  00060	d1 e8		 shr	 eax, 1
  00062	89 45 08	 mov	 DWORD PTR _refx$[ebp], eax

; 129  : 	} 

  00065	eb c7		 jmp	 SHORT $LN3@reflect
$LN2@reflect:

; 130  : 	return value; 

  00067	8b 45 f8	 mov	 eax, DWORD PTR _value$[ebp]

; 131  : }

  0006a	5f		 pop	 edi
  0006b	5e		 pop	 esi
  0006c	5b		 pop	 ebx
  0006d	8b e5		 mov	 esp, ebp
  0006f	5d		 pop	 ebp
  00070	c3		 ret	 0
_reflect ENDP
_TEXT	ENDS
PUBLIC	_GenCrc32
; Function compile flags: /Odtp /RTCsu /ZI
;	COMDAT _GenCrc32
_TEXT	SEGMENT
tv66 = -268						; size = 4
_t$ = -65						; size = 1
_c$ = -53						; size = 1
_charcnt$ = -44						; size = 4
_oldcrc$ = -32						; size = 4
_crc32$ = -20						; size = 4
_oldcrc32$ = -8						; size = 4
_pDataBuf$ = 8						; size = 4
_nLen$ = 12						; size = 4
_GenCrc32 PROC						; COMDAT

; 161  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 0c 01 00
	00		 sub	 esp, 268		; 0000010cH
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd f4 fe ff
	ff		 lea	 edi, DWORD PTR [ebp-268]
  00012	b9 43 00 00 00	 mov	 ecx, 67			; 00000043H
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 162  : 	unsigned int oldcrc32;
; 163  : 	unsigned int crc32;
; 164  : 	unsigned int oldcrc;
; 165  : 	unsigned int charcnt;
; 166  : 	unsigned char c, t;
; 167  : 	oldcrc32 = 0x0; //初值为0 

  0001e	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _oldcrc32$[ebp], 0

; 168  : 	charcnt = 0;

  00025	c7 45 d4 00 00
	00 00		 mov	 DWORD PTR _charcnt$[ebp], 0
$LN2@GenCrc32:

; 169  : 	while ((nLen--) > 0)

  0002c	8b 45 0c	 mov	 eax, DWORD PTR _nLen$[ebp]
  0002f	8b 4d 0c	 mov	 ecx, DWORD PTR _nLen$[ebp]
  00032	83 e9 01	 sub	 ecx, 1
  00035	89 4d 0c	 mov	 DWORD PTR _nLen$[ebp], ecx
  00038	85 c0		 test	 eax, eax
  0003a	76 0c		 jbe	 SHORT $LN5@GenCrc32
  0003c	c7 85 f4 fe ff
	ff 01 00 00 00	 mov	 DWORD PTR tv66[ebp], 1
  00046	eb 0a		 jmp	 SHORT $LN6@GenCrc32
$LN5@GenCrc32:
  00048	c7 85 f4 fe ff
	ff 00 00 00 00	 mov	 DWORD PTR tv66[ebp], 0
$LN6@GenCrc32:
  00052	83 bd f4 fe ff
	ff 00		 cmp	 DWORD PTR tv66[ebp], 0
  00059	74 4a		 je	 SHORT $LN1@GenCrc32

; 170  : 	{
; 171  : 		//要移出的字节的值 
; 172  : 		t = (unsigned char)((oldcrc32 >> 24) & 0xFF);

  0005b	8b 45 f8	 mov	 eax, DWORD PTR _oldcrc32$[ebp]
  0005e	c1 e8 18	 shr	 eax, 24			; 00000018H
  00061	25 ff 00 00 00	 and	 eax, 255		; 000000ffH
  00066	88 45 bf	 mov	 BYTE PTR _t$[ebp], al

; 173  : 		//根据移出的字节的值查表 
; 174  : 		oldcrc = crc32Table[t];

  00069	0f b6 45 bf	 movzx	 eax, BYTE PTR _t$[ebp]
  0006d	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR _crc32Table[eax*4]
  00074	89 4d e0	 mov	 DWORD PTR _oldcrc$[ebp], ecx

; 175  : 		//新移进来的字节值
; 176  : 		c = pDataBuf[charcnt];

  00077	8b 45 08	 mov	 eax, DWORD PTR _pDataBuf$[ebp]
  0007a	03 45 d4	 add	 eax, DWORD PTR _charcnt$[ebp]
  0007d	8a 08		 mov	 cl, BYTE PTR [eax]
  0007f	88 4d cb	 mov	 BYTE PTR _c$[ebp], cl

; 177  : 		//将寄存器与查出的值进行xor运算
; 178  : 		oldcrc32 = (oldcrc32 << 8) | c;

  00082	8b 45 f8	 mov	 eax, DWORD PTR _oldcrc32$[ebp]
  00085	c1 e0 08	 shl	 eax, 8
  00088	0f b6 4d cb	 movzx	 ecx, BYTE PTR _c$[ebp]
  0008c	0b c1		 or	 eax, ecx
  0008e	89 45 f8	 mov	 DWORD PTR _oldcrc32$[ebp], eax

; 179  : 		oldcrc32 = oldcrc32 ^ oldcrc;

  00091	8b 45 f8	 mov	 eax, DWORD PTR _oldcrc32$[ebp]
  00094	33 45 e0	 xor	 eax, DWORD PTR _oldcrc$[ebp]
  00097	89 45 f8	 mov	 DWORD PTR _oldcrc32$[ebp], eax

; 180  : 		charcnt++;

  0009a	8b 45 d4	 mov	 eax, DWORD PTR _charcnt$[ebp]
  0009d	83 c0 01	 add	 eax, 1
  000a0	89 45 d4	 mov	 DWORD PTR _charcnt$[ebp], eax

; 181  : 	}

  000a3	eb 87		 jmp	 SHORT $LN2@GenCrc32
$LN1@GenCrc32:

; 182  : 	crc32 = oldcrc32;

  000a5	8b 45 f8	 mov	 eax, DWORD PTR _oldcrc32$[ebp]
  000a8	89 45 ec	 mov	 DWORD PTR _crc32$[ebp], eax

; 183  : 	return crc32;

  000ab	8b 45 ec	 mov	 eax, DWORD PTR _crc32$[ebp]

; 184  : }

  000ae	5f		 pop	 edi
  000af	5e		 pop	 esi
  000b0	5b		 pop	 ebx
  000b1	8b e5		 mov	 esp, ebp
  000b3	5d		 pop	 ebp
  000b4	c3		 ret	 0
_GenCrc32 ENDP
_TEXT	ENDS
PUBLIC	_GenCrc64
EXTRN	__allshl:PROC
EXTRN	__allmul:PROC
EXTRN	__aullshr:PROC
; Function compile flags: /Odtp /RTCsu /ZI
;	COMDAT _GenCrc64
_TEXT	SEGMENT
_i$ = -40						; size = 4
_tableIndex$ = -28					; size = 8
_crc64$ = -12						; size = 8
_pDataBuf$ = 8						; size = 4
_nLen$ = 12						; size = 4
_GenCrc64 PROC						; COMDAT

; 187  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec ec 00 00
	00		 sub	 esp, 236		; 000000ecH
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi
  0000c	8d bd 14 ff ff
	ff		 lea	 edi, DWORD PTR [ebp-236]
  00012	b9 3b 00 00 00	 mov	 ecx, 59			; 0000003bH
  00017	b8 cc cc cc cc	 mov	 eax, -858993460		; ccccccccH
  0001c	f3 ab		 rep stosd

; 188  : 	unsigned long long crc64 = 0xffffffffffffffff;

  0001e	c7 45 f4 ff ff
	ff ff		 mov	 DWORD PTR _crc64$[ebp], -1
  00025	c7 45 f8 ff ff
	ff ff		 mov	 DWORD PTR _crc64$[ebp+4], -1

; 189  : 	unsigned long long tableIndex = 0;

  0002c	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _tableIndex$[ebp], 0
  00033	c7 45 e8 00 00
	00 00		 mov	 DWORD PTR _tableIndex$[ebp+4], 0

; 190  : 	unsigned int i;
; 191  : 	for (i = 0; i < nLen; i++)

  0003a	c7 45 d8 00 00
	00 00		 mov	 DWORD PTR _i$[ebp], 0
  00041	eb 09		 jmp	 SHORT $LN3@GenCrc64
$LN2@GenCrc64:
  00043	8b 45 d8	 mov	 eax, DWORD PTR _i$[ebp]
  00046	83 c0 01	 add	 eax, 1
  00049	89 45 d8	 mov	 DWORD PTR _i$[ebp], eax
$LN3@GenCrc64:
  0004c	8b 45 d8	 mov	 eax, DWORD PTR _i$[ebp]
  0004f	3b 45 0c	 cmp	 eax, DWORD PTR _nLen$[ebp]
  00052	73 62		 jae	 SHORT $LN1@GenCrc64

; 192  : 	{
; 193  : 		tableIndex = (((unsigned long long)(crc64 >> 56)) ^ pDataBuf[i]) & 0xff;

  00054	8b 45 f4	 mov	 eax, DWORD PTR _crc64$[ebp]
  00057	8b 55 f8	 mov	 edx, DWORD PTR _crc64$[ebp+4]
  0005a	b1 38		 mov	 cl, 56			; 00000038H
  0005c	e8 00 00 00 00	 call	 __aullshr
  00061	8b c8		 mov	 ecx, eax
  00063	8b f2		 mov	 esi, edx
  00065	8b 55 08	 mov	 edx, DWORD PTR _pDataBuf$[ebp]
  00068	03 55 d8	 add	 edx, DWORD PTR _i$[ebp]
  0006b	0f b6 02	 movzx	 eax, BYTE PTR [edx]
  0006e	99		 cdq
  0006f	33 c8		 xor	 ecx, eax
  00071	33 f2		 xor	 esi, edx
  00073	81 e1 ff 00 00
	00		 and	 ecx, 255		; 000000ffH
  00079	83 e6 00	 and	 esi, 0
  0007c	89 4d e4	 mov	 DWORD PTR _tableIndex$[ebp], ecx
  0007f	89 75 e8	 mov	 DWORD PTR _tableIndex$[ebp+4], esi

; 194  : 		crc64 = crc64Table[tableIndex] ^ (crc64 << 8);

  00082	6a 00		 push	 0
  00084	6a 08		 push	 8
  00086	8b 45 e8	 mov	 eax, DWORD PTR _tableIndex$[ebp+4]
  00089	50		 push	 eax
  0008a	8b 4d e4	 mov	 ecx, DWORD PTR _tableIndex$[ebp]
  0008d	51		 push	 ecx
  0008e	e8 00 00 00 00	 call	 __allmul
  00093	8b f0		 mov	 esi, eax
  00095	8b 45 f4	 mov	 eax, DWORD PTR _crc64$[ebp]
  00098	8b 55 f8	 mov	 edx, DWORD PTR _crc64$[ebp+4]
  0009b	b1 08		 mov	 cl, 8
  0009d	e8 00 00 00 00	 call	 __allshl
  000a2	33 86 00 00 00
	00		 xor	 eax, DWORD PTR _crc64Table[esi]
  000a8	33 96 04 00 00
	00		 xor	 edx, DWORD PTR _crc64Table[esi+4]
  000ae	89 45 f4	 mov	 DWORD PTR _crc64$[ebp], eax
  000b1	89 55 f8	 mov	 DWORD PTR _crc64$[ebp+4], edx

; 195  : 	}

  000b4	eb 8d		 jmp	 SHORT $LN2@GenCrc64
$LN1@GenCrc64:

; 196  : 	return (crc64 ^ 0xffffffffffffffff); 

  000b6	8b 45 f4	 mov	 eax, DWORD PTR _crc64$[ebp]
  000b9	83 f0 ff	 xor	 eax, -1
  000bc	8b 55 f8	 mov	 edx, DWORD PTR _crc64$[ebp+4]
  000bf	83 f2 ff	 xor	 edx, -1

; 197  : }

  000c2	5f		 pop	 edi
  000c3	5e		 pop	 esi
  000c4	5b		 pop	 ebx
  000c5	81 c4 ec 00 00
	00		 add	 esp, 236		; 000000ecH
  000cb	3b ec		 cmp	 ebp, esp
  000cd	e8 00 00 00 00	 call	 __RTC_CheckEsp
  000d2	8b e5		 mov	 esp, ebp
  000d4	5d		 pop	 ebp
  000d5	c3		 ret	 0
_GenCrc64 ENDP
_TEXT	ENDS
END
